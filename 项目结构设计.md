# PPT讲稿生成器 - 项目结构设计

## 📁 项目目录结构

```
ppt-lecture-generator/
├── src/                        # 源代码目录
│   ├── __init__.py
│   ├── main.py                 # 主程序入口
│   ├── gui/                    # GUI界面模块
│   │   ├── __init__.py
│   │   ├── main_window.py      # 主窗口类
│   │   ├── components/         # 自定义组件
│   │   │   ├── __init__.py
│   │   │   ├── config_panel.py    # 配置面板
│   │   │   ├── file_panel.py      # 文件上传面板
│   │   │   ├── control_panel.py   # 控制面板
│   │   │   └── preview_panel.py   # 预览面板
│   │   └── styles.py           # 界面样式和主题
│   ├── core/                   # 核心业务逻辑
│   │   ├── __init__.py
│   │   ├── ppt_processor.py    # PPT处理和截图
│   │   ├── ai_client.py        # AI API调用客户端
│   │   ├── script_generator.py # 讲稿生成逻辑
│   │   └── context_manager.py  # 上下文管理
│   ├── config/                 # 配置管理模块
│   │   ├── __init__.py
│   │   ├── settings.py         # 设置管理类
│   │   ├── constants.py        # 常量定义
│   │   └── default_config.json # 默认配置
│   └── utils/                  # 工具函数模块
│       ├── __init__.py
│       ├── file_utils.py       # 文件操作工具
│       ├── image_utils.py      # 图片处理工具
│       ├── validators.py       # 验证函数
│       └── logger.py           # 日志管理
├── tests/                      # 单元测试
│   ├── __init__.py
│   ├── test_ppt_processor.py
│   ├── test_ai_client.py
│   └── test_script_generator.py
├── docs/                       # 文档目录
│   ├── API文档.md
│   ├── 开发指南.md
│   └── 用户手册.md
├── resources/                  # 资源文件
│   ├── icons/                  # 图标文件
│   ├── templates/              # 模板文件
│   └── examples/               # 示例文件
├── requirements.txt            # Python依赖
├── setup.py                    # 安装脚本
├── config.ini                  # 用户配置文件
└── README.md                   # 项目说明
```

## 🔧 模块设计原则

### 1. 分层架构
- **GUI层**: 负责用户界面和交互
- **业务逻辑层**: 核心功能实现
- **工具层**: 通用工具和辅助功能
- **配置层**: 设置管理和常量定义

### 2. 模块职责
- **gui/**: 界面相关，不包含业务逻辑
- **core/**: 核心功能，与界面解耦
- **config/**: 配置管理，支持热更新
- **utils/**: 工具函数，可复用组件

### 3. 接口设计
- 模块间通过明确的接口通信
- 使用抽象基类定义规范
- 支持依赖注入和配置化

## 📋 核心模块功能说明

### GUI模块
- `main_window.py`: 主窗口管理，布局协调
- `config_panel.py`: API配置界面
- `file_panel.py`: 文件上传和预览
- `control_panel.py`: 处理控制按钮
- `preview_panel.py`: 结果预览和保存

### Core模块
- `ppt_processor.py`: PPT文件处理和图片转换
- `ai_client.py`: AI API调用封装
- `script_generator.py`: 讲稿生成算法
- `context_manager.py`: 上下文和状态管理

### Config模块
- `settings.py`: 配置文件读写管理
- `constants.py`: 应用常量定义
- `default_config.json`: 默认配置模板

### Utils模块
- `file_utils.py`: 文件操作、路径处理
- `image_utils.py`: 图片格式转换、压缩
- `validators.py`: 输入验证、格式检查
- `logger.py`: 日志记录和错误追踪

## 🚀 开发流程

1. **第一阶段**: 搭建项目框架和基础模块
2. **第二阶段**: 实现核心功能模块
3. **第三阶段**: 开发GUI界面和交互
4. **第四阶段**: 集成测试和优化

## 📊 技术栈选择

- **GUI框架**: Tkinter (标准库) / PyQt5 (可选)
- **HTTP客户端**: requests
- **图片处理**: Pillow, pdf2image
- **PPT处理**: python-pptx, spire.presentation
- **配置管理**: configparser, json
- **日志记录**: logging
- **测试框架**: unittest, pytest

## 🔄 扩展性设计

- 插件化架构，支持自定义处理器
- 配置化模型选择和参数调整
- 多语言支持框架
- 主题和样式自定义
- 批量处理和任务队列

这个设计保证了代码的模块化、可测试性和可维护性。